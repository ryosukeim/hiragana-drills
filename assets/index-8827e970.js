(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const n of s.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&r(n)}).observe(document,{childList:!0,subtree:!0});function t(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(a){if(a.ep)return;a.ep=!0;const s=t(a);fetch(a.href,s)}})();const v="modulepreload",w=function(o){return"/hiragana-drills/"+o},h={},g=function(e,t,r){if(!t||t.length===0)return e();const a=document.getElementsByTagName("link");return Promise.all(t.map(s=>{if(s=w(s),s in h)return;h[s]=!0;const n=s.endsWith(".css"),i=n?'[rel="stylesheet"]':"";if(!!r)for(let l=a.length-1;l>=0;l--){const d=a[l];if(d.href===s&&(!n||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${i}`))return;const c=document.createElement("link");if(c.rel=n?"stylesheet":v,n||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),n)return new Promise((l,d)=>{c.addEventListener("load",l),c.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const n=new Event("vite:preloadError",{cancelable:!0});if(n.payload=s,window.dispatchEvent(n),!n.defaultPrevented)throw s})};class P{constructor(){this.currentScreen=null,this.container=null}init(e){this.container=e}navigateTo(e){if(this.currentScreen&&this.currentScreen.onLeave&&this.currentScreen.onLeave(),this.currentScreen=e,this.container.innerHTML="",e.render){const t=e.render();this.container.appendChild(t),e.onEnter&&e.onEnter()}}goBack(){g(()=>Promise.resolve().then(()=>D),void 0).then(e=>{this.navigateTo(new e.HomeScreen(this))})}}const _=new P,b="KanaSpaceDB",S=1;class k{constructor(){this.db=null,this.currentProfile="default"}async init(){return new Promise((e,t)=>{const r=indexedDB.open(b,S);r.onerror=()=>t(r.error),r.onsuccess=()=>{this.db=r.result,this.loadCurrentProfile(),e()},r.onupgradeneeded=a=>{const s=a.target.result;if(s.objectStoreNames.contains("settings")||s.createObjectStore("settings",{keyPath:"key"}),s.objectStoreNames.contains("profiles")||s.createObjectStore("profiles",{keyPath:"name"}),!s.objectStoreNames.contains("progress")){const n=s.createObjectStore("progress",{keyPath:"id",autoIncrement:!0});n.createIndex("profile","profile",{unique:!1}),n.createIndex("wordId","wordId",{unique:!1})}s.objectStoreNames.contains("gamification")||s.createObjectStore("gamification",{keyPath:"profile"})}})}async get(e,t){return this.db||await this.init(),new Promise((r,a)=>{const i=this.db.transaction([e],"readonly").objectStore(e).get(t);i.onsuccess=()=>r(i.result),i.onerror=()=>a(i.error)})}async put(e,t){return this.db||await this.init(),new Promise((r,a)=>{const i=this.db.transaction([e],"readwrite").objectStore(e).put(t);i.onsuccess=()=>r(i.result),i.onerror=()=>a(i.error)})}async getAll(e){return this.db||await this.init(),new Promise((t,r)=>{const n=this.db.transaction([e],"readonly").objectStore(e).getAll();n.onsuccess=()=>t(n.result),n.onerror=()=>r(n.error)})}async getSetting(e,t=null){const r=await this.get("settings",e);return r?r.value:t}async setSetting(e,t){await this.put("settings",{key:e,value:t})}loadCurrentProfile(){const e=localStorage.getItem("currentProfile");e&&(this.currentProfile=e)}setCurrentProfile(e){this.currentProfile=e,localStorage.setItem("currentProfile",e)}async getProfile(e=this.currentProfile){let t=await this.get("profiles",e);return t||(t={name:e,createdAt:Date.now(),lastActiveAt:Date.now()},await this.put("profiles",t)),t}async getGamificationData(e=this.currentProfile){let t=await this.get("gamification",e);return t||(t={profile:e,xp:0,level:1,streak:0,lastPracticeDate:null,collectibles:[],missions:{}},await this.put("gamification",t)),t}async updateGamificationData(e,t=this.currentProfile){const a={...await this.getGamificationData(t),...e};return await this.put("gamification",a),a}async saveWordProgress(e,t,r,a){const s={profile:this.currentProfile,wordId:e,kanaChar:t,score:r,mode:a,timestamp:Date.now()};await this.put("progress",s)}async getWordProgress(e){return(await this.getAll("progress")).filter(r=>r.profile===this.currentProfile&&r.wordId===e)}async getKanaMastery(e){const r=(await this.getAll("progress")).filter(s=>s.profile===this.currentProfile&&s.kanaChar===e);if(r.length===0)return 0;const a=r.reduce((s,n)=>s+n.score,0)/r.length;return Math.round(a)}async updateStreak(){const e=await this.getGamificationData(),t=new Date().toDateString(),r=e.lastPracticeDate?new Date(e.lastPracticeDate).toDateString():null;let a=e.streak;return r===t?e:(r===new Date(Date.now()-864e5).toDateString()?a+=1:a=1,await this.updateGamificationData({streak:a,lastPracticeDate:Date.now()}))}async addXP(e){const t=await this.getGamificationData(),r=t.xp+e,a=Math.floor(r/100)+1,s=a>t.level;return{...await this.updateGamificationData({xp:r,level:a}),leveledUp:s}}async addCollectible(e){const t=await this.getGamificationData();t.collectibles.includes(e)||(t.collectibles.push(e),await this.put("gamification",t))}async hasCollectible(e){return(await this.getGamificationData()).collectibles.includes(e)}}const f=new k,x={en:{appName:"Kana Space Adventure",home_title:"Ready for Adventure?",home_dailyPractice:"Daily Practice",home_practice:"Practice",home_progress:"Progress",home_settings:"Settings",home_streak:"Day Streak",home_level:"Level",settings_title:"Settings",settings_kanaSet:"Kana Set",settings_hiragana:"Hiragana",settings_katakana:"Katakana",settings_wordLevel:"Word Level",settings_beginner:"Beginner",settings_intermediate:"Intermediate",settings_advanced:"Advanced",settings_hintMode:"Hint Mode",settings_easy:"Easy (Stroke Order)",settings_normal:"Normal (Arrows)",settings_hard:"Hard (No Hints)",settings_appLanguage:"App Language",settings_english:"English",settings_japanese:"Êó•Êú¨Ë™û",settings_profile:"Profile",settings_back:"Back",practice_title:"Practice Time!",practice_loading:"Loading...",practice_playEnglish:"Play English",practice_playJapanese:"Play Japanese",practice_practiceWriting:"Practice Writing",practice_next:"Next",practice_complete:"Practice Complete!",writing_title:"Write the Kana",writing_trace:"Trace Mode",writing_freeWrite:"Free Write",writing_clear:"Clear",writing_hint:"Show Hint",writing_submit:"Submit",writing_tryAgain:"Try Again",writing_target:"Target:",results_awesome:"Awesome!",results_great:"Great Job!",results_good:"Good Try!",results_tryAgain:"Let's Practice!",results_score:"Score",results_xpEarned:"XP Earned",results_newLevel:"Level Up!",results_unlocked:"Unlocked",results_next:"Next Word",results_finish:"Finish",progress_title:"Your Progress",progress_streak:"Streak",progress_days:"days",progress_xp:"XP",progress_level:"Level",progress_kanaMastery:"Kana Mastery",progress_collectibles:"Collectibles",progress_missions:"Missions",progress_back:"Back",mission_trace5:"Trace 5 kana",mission_score80:"Get 80+ score twice",mission_streak3:"Practice 3 days in a row",mission_complete10:"Complete 10 items",feedback_perfect:"Perfect! You're a star!",feedback_excellent:"Excellent work!",feedback_great:"Great tracing!",feedback_good:"Good job!",feedback_tryAgain:"Good try! Let's practice once more!",feedback_keepPracticing:"Keep practicing! You can do it!",general_loading:"Loading...",general_ok:"OK",general_cancel:"Cancel",general_save:"Save",general_delete:"Delete",general_edit:"Edit",general_add:"Add",general_close:"Close",category_animals:"Animals",category_food:"Food",category_colors:"Colors",category_numbers:"Numbers",category_everyday:"Everyday"},ja:{appName:"„Åã„Å™„Çπ„Éö„Éº„Çπ„Ç¢„Éâ„Éô„É≥„ÉÅ„É£„Éº",home_title:"„Åº„ÅÜ„Åë„Çì„Å´„ÅÑ„ÅèÔºü",home_dailyPractice:"„Åæ„ÅÑ„Å´„Å°„Çå„Çì„Åó„ÇÖ„ÅÜ",home_practice:"„Çå„Çì„Åó„ÇÖ„ÅÜ",home_progress:"„Åõ„ÅÑ„Å°„Çá„ÅÜ",home_settings:"„Åõ„Å£„Å¶„ÅÑ",home_streak:"Êó•„Çå„Çì„Åû„Åè",home_level:"„É¨„Éô„É´",settings_title:"„Åõ„Å£„Å¶„ÅÑ",settings_kanaSet:"„Åã„Å™„ÅÆ„Åó„ÇÖ„Çã„ÅÑ",settings_hiragana:"„Å≤„Çâ„Åå„Å™",settings_katakana:"„Ç´„Çø„Ç´„Éä",settings_wordLevel:"„ÇÄ„Åö„Åã„Åó„Åï",settings_beginner:"„Åã„Çì„Åü„Çì",settings_intermediate:"„Åµ„Å§„ÅÜ",settings_advanced:"„ÇÄ„Åö„Åã„Åó„ÅÑ",settings_hintMode:"„Éí„É≥„Éà„É¢„Éº„Éâ",settings_easy:"„Åã„Çì„Åü„ÇìÔºà„Åã„Åç„Åò„ÇÖ„ÇìÔºâ",settings_normal:"„Åµ„Å§„ÅÜÔºà„ÇÑ„Åò„Çã„ÅóÔºâ",settings_hard:"„ÇÄ„Åö„Åã„Åó„ÅÑÔºà„Éí„É≥„Éà„Å™„ÅóÔºâ",settings_appLanguage:"„Ç¢„Éó„É™„ÅÆ„Åì„Å®„Å∞",settings_english:"English",settings_japanese:"Êó•Êú¨Ë™û",settings_profile:"„Éó„É≠„Éï„Ç£„Éº„É´",settings_back:"„ÇÇ„Å©„Çã",practice_title:"„Çå„Çì„Åó„ÇÖ„ÅÜ„Çø„Ç§„É†ÔºÅ",practice_loading:"„Çà„Åø„Åì„Åø„Å°„ÇÖ„ÅÜ...",practice_playEnglish:"„Åà„ÅÑ„Åî„Çí„Åç„Åè",practice_playJapanese:"„Å´„Åª„Çì„Åî„Çí„Åç„Åè",practice_practiceWriting:"„Åã„Åè„Çå„Çì„Åó„ÇÖ„ÅÜ",practice_next:"„Å§„Åé„Å∏",practice_complete:"„Çå„Çì„Åó„ÇÖ„ÅÜ„Åã„Çì„Çä„Çá„ÅÜÔºÅ",writing_title:"„Åã„Å™„Çí„Åã„Åì„ÅÜ",writing_trace:"„Å™„Åû„Çã„É¢„Éº„Éâ",writing_freeWrite:"„Åò„ÇÜ„ÅÜ„É¢„Éº„Éâ",writing_clear:"„Åë„Åô",writing_hint:"„Éí„É≥„Éà",writing_submit:"„Åã„Åè„Å´„Çì",writing_tryAgain:"„ÇÇ„ÅÜ„ÅÑ„Å°„Å©",writing_target:"„ÇÇ„Åè„Å≤„Çá„ÅÜÔºö",results_awesome:"„Åô„Åî„ÅÑÔºÅ",results_great:"„Çà„Åè„Åß„Åç„Åæ„Åó„ÅüÔºÅ",results_good:"„ÅÑ„ÅÑ„Å≠ÔºÅ",results_tryAgain:"„Çå„Çì„Åó„ÇÖ„ÅÜ„Åó„Çà„ÅÜÔºÅ",results_score:"„Çπ„Ç≥„Ç¢",results_xpEarned:"XP„Ç≤„ÉÉ„Éà",results_newLevel:"„É¨„Éô„É´„Ç¢„ÉÉ„ÉóÔºÅ",results_unlocked:"„Ç¢„É≥„É≠„ÉÉ„ÇØ",results_next:"„Å§„Åé„ÅÆ„Åì„Å®„Å∞",results_finish:"„Åä„Çè„Çä",progress_title:"„ÅÇ„Å™„Åü„ÅÆ„Åõ„ÅÑ„Å°„Çá„ÅÜ",progress_streak:"„Çå„Çì„Åû„Åè",progress_days:"Êó•",progress_xp:"XP",progress_level:"„É¨„Éô„É´",progress_kanaMastery:"„Åã„Å™„Éû„Çπ„Çø„Éº",progress_collectibles:"„Ç≥„É¨„ÇØ„Ç∑„Éß„É≥",progress_missions:"„Éü„ÉÉ„Ç∑„Éß„É≥",progress_back:"„ÇÇ„Å©„Çã",mission_trace5:"„Åã„Å™„Çí5„Åì„Å™„Åû„Çã",mission_score80:"80„ÅÑ„Åò„Çá„ÅÜ„Çí2„Åã„ÅÑ„Å®„Çã",mission_streak3:"3Êó•„Çå„Çì„Åû„Åè„Åß„Çå„Çì„Åó„ÇÖ„ÅÜ",mission_complete10:"10„Åì„ÇØ„É™„Ç¢",feedback_perfect:"„Éë„Éº„Éï„Çß„ÇØ„ÉàÔºÅ„Çπ„Çø„Éº„Å†„Å≠ÔºÅ",feedback_excellent:"„Åô„Å∞„Çâ„Åó„ÅÑÔºÅ",feedback_great:"„Å®„Å¶„ÇÇ„Åò„Çá„ÅÜ„ÅöÔºÅ",feedback_good:"„Çà„Åè„Åß„Åç„Åæ„Åó„ÅüÔºÅ",feedback_tryAgain:"„ÅÑ„ÅÑ„Å≠ÔºÅ„ÇÇ„ÅÜ„ÅÑ„Å°„Å©„ÇÑ„Å£„Å¶„Åø„Çà„ÅÜÔºÅ",feedback_keepPracticing:"„Çå„Çì„Åó„ÇÖ„ÅÜ„Åó„Çà„ÅÜÔºÅ„Åç„Åø„Å™„Çâ„Åß„Åç„ÇãÔºÅ",general_loading:"„Çà„Åø„Åì„Åø„Å°„ÇÖ„ÅÜ...",general_ok:"OK",general_cancel:"„Ç≠„É£„É≥„Çª„É´",general_save:"„Åª„Åû„Çì",general_delete:"„Åï„Åè„Åò„Çá",general_edit:"„Å∏„Çì„Åó„ÇÖ„ÅÜ",general_add:"„Å§„ÅÑ„Åã",general_close:"„Å®„Åò„Çã",category_animals:"„Å©„ÅÜ„Å∂„Å§",category_food:"„Åü„Åπ„ÇÇ„ÅÆ",category_colors:"„ÅÑ„Çç",category_numbers:"„Åã„Åö",category_everyday:"„Åæ„ÅÑ„Å´„Å°"}};class L{constructor(){this.currentLang="en",this.loadLanguage()}loadLanguage(){const e=localStorage.getItem("appLanguage");e&&(e==="en"||e==="ja")&&(this.currentLang=e)}saveLanguage(e){this.currentLang=e,localStorage.setItem("appLanguage",e)}getLang(){return this.currentLang}setLang(e){e!=="en"&&e!=="ja"&&(console.warn(`Unsupported language: ${e}, defaulting to 'en'`),e="en"),this.saveLanguage(e),this.updateDOM()}t(e){const t=x[this.currentLang][e];return t||(console.warn(`Missing translation for key: ${e} in language: ${this.currentLang}`),e)}updateDOM(){document.querySelectorAll("[data-i18n]").forEach(t=>{const r=t.getAttribute("data-i18n"),a=this.t(r);t.tagName==="INPUT"||t.tagName==="TEXTAREA"?t.placeholder=a:t.textContent=a})}createElement(e,t,r=""){const a=document.createElement(e);return a.setAttribute("data-i18n",t),a.textContent=this.t(t),r&&(a.className=r),a}}const u=new L;class y{constructor(e){this.router=e,this.gamificationData=null}async loadData(){this.gamificationData=await f.getGamificationData()}render(){var c,l;const e=document.createElement("div");e.className="screen flex-col items-center justify-center gap-xl p-xl",e.style.minHeight="100vh";const t=document.createElement("div");t.className="text-center mb-xl",t.innerHTML=`
      <div class="mascot-container mb-md animate-float">
        <div style="font-size: 120px;">üöÄ</div>
      </div>
      <h1 data-i18n="home_title" class="text-primary mb-md">${u.t("home_title")}</h1>
    `;const r=document.createElement("div");r.className="flex gap-lg mb-xl",r.innerHTML=`
      <div class="card flex-col items-center gap-sm p-lg">
        <div style="font-size: 32px;">üî•</div>
        <div class="text-2xl font-bold">${((c=this.gamificationData)==null?void 0:c.streak)||0}</div>
        <div class="text-sm text-secondary" data-i18n="home_streak">${u.t("home_streak")}</div>
      </div>
      <div class="card flex-col items-center gap-sm p-lg">
        <div style="font-size: 32px;">‚≠ê</div>
        <div class="text-2xl font-bold">${((l=this.gamificationData)==null?void 0:l.level)||1}</div>
        <div class="text-sm text-secondary" data-i18n="home_level">${u.t("home_level")}</div>
      </div>
    `;const a=document.createElement("div");a.className="flex-col gap-md",a.style.width="100%",a.style.maxWidth="400px";const s=this.createButton("home_dailyPractice","‚≠ê",()=>this.startDailyPractice()),n=this.createButton("home_practice","üìù",()=>this.goToPractice()),i=this.createButton("home_progress","üìä",()=>this.goToProgress()),p=this.createButton("home_settings","‚öôÔ∏è",()=>this.goToSettings());return a.appendChild(s),a.appendChild(n),a.appendChild(i),a.appendChild(p),e.appendChild(t),e.appendChild(r),e.appendChild(a),e}createButton(e,t,r){const a=document.createElement("button");return a.className="btn btn-large",a.innerHTML=`
      <span style="font-size: 28px;">${t}</span>
      <span data-i18n="${e}">${u.t(e)}</span>
    `,a.onclick=r,a}async onEnter(){var t,r;await this.loadData();const e=document.querySelectorAll(".card .text-2xl");e.length>=2&&(e[0].textContent=((t=this.gamificationData)==null?void 0:t.streak)||0,e[1].textContent=((r=this.gamificationData)==null?void 0:r.level)||1)}async startDailyPractice(){const{PracticeScreen:e}=await g(()=>import("./PracticeScreen-b267e345.js").then(t=>t.P),[]);this.router.navigateTo(new e(this.router,"daily"))}async goToPractice(){const{PracticeScreen:e}=await g(()=>import("./PracticeScreen-b267e345.js").then(t=>t.P),[]);this.router.navigateTo(new e(this.router,"custom"))}async goToProgress(){const{ProgressScreen:e}=await g(()=>import("./ProgressScreen-156a28fa.js"),["assets/ProgressScreen-156a28fa.js","assets/kana-data-373ad0d8.js"]);this.router.navigateTo(new e(this.router))}async goToSettings(){const{SettingsScreen:e}=await g(()=>import("./SettingsScreen-40aac366.js"),[]);this.router.navigateTo(new e(this.router))}}const D=Object.freeze(Object.defineProperty({__proto__:null,HomeScreen:y},Symbol.toStringTag,{value:"Module"}));async function m(){try{await f.init();const o=document.getElementById("screen-container");_.init(o);const e=new y(_);_.navigateTo(e),console.log("üöÄ Kana Space Adventure initialized!")}catch(o){console.error("Failed to initialize app:",o);const e=document.getElementById("screen-container");e.innerHTML=`
      <div class="card card-gradient text-center p-xl" style="margin: 20px;">
        <h2>Oops! Something went wrong</h2>
        <p>Please refresh the page to try again.</p>
        <p class="text-sm text-muted mt-md">${o.message}</p>
      </div>
    `}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",m):m();export{g as _,u as i,f as s};
